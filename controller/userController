const db = require('./../db')()


//const result = await connection.execute(
//    `SELECT * FROM your_table WHERE some_column = :value`,
//    [value]
//);


//const result = await connection.execute(
//    `INSERT INTO your_table (column1, column2, ...) VALUES (:val1, :val2, ...)`,
//    data // Array containing values corresponding to the placeholders
//);


//function to insert new user into 'utilisateurs' table
exports.addUser = async (req, res) => {

    const { id_user, nomUser, mdp } = req.body;

    const userID = req.params.id;

    try {
        const newUser = await db.execute(
            `UPDATE utilisateurs SET (id_user = :val1, nomUser = :val2, mdp = :val3) WHERE id_user = :val4`,
            [id_user, nomUser, mdp, userID]
        );
        
        res.status(201).json({
            status: 'success',
            data: newUser
        })
        
        } catch (error) {
        
        res.status(400).json({
            status: 'fail',
            message: error.message
        })
    }
}

//function to update user
exports.updateUser = async (req, res) => {
    const userID = req.params.id

    try {
        const deletedUSer = await db.execute(
            `DELET FROM utilisateurs WHERE id_user = :val1`,
            [userID]
        );
        
        res.status(202).json({
            status: 'success',
            data: deletedUSer
        })
        
        } catch (error) {
        
        res.status(400).json({
            status: 'fail',
            message: error.message
        })
    }
}

//function to delet a user
exports.deletUser = async (req, res) => {

    const userID = req.params.id

    try {
        const deletedUSer = await db.execute(
            `DELET FROM utilisateurs WHERE id_user = :val1`,
            [userID]
        );
        
        res.status(202).json({
            status: 'success',
            data: deletedUSer
        })
        
        } catch (error) {
        
        res.status(400).json({
            status: 'fail',
            message: error.message
        })
    }
}